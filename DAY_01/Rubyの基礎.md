# Rubyの基礎
Ruby on Rails開発に必要最低限のRuby知識を記載しています。より詳しくRubyを学びたいかたは、[たのしいRuby](http://www.amazon.co.jp/dp/4797372273)がおすすめです。

## 基本

```ruby
puts("スパルタキャンプへようこそ！")
```

- `puts`がメソッド
	- Rubyがもっている機能を呼び出すこと
	- putsは文字列を改行付きで出力する機能
- `()`で囲まれた部分が引数（ひきすう）
	- メソッドに指定する数値や文字列
- `""`で囲まれた部分は文字列オブジェクト

## 変数
数値や文字列などを入れる「箱」のようなもの。箱にラベルをつけるイメージが変数。

```ruby
today = "2015/06/06"
puts today
```

### 変数の種類
変数にはいくつか種類がある。

変数名|種類|
-----|----|
sparta|ローカル変数|
$sparta|グローバル変数|
@sparta|インスタンス変数|
@@sparta|クラス変数|
SPARTA|定数|

- ローカル変数とインスタンス変数が最重要

### 命名規則
- すべて半角のアルファベット、数値、`_`のどれかしか使えない
- 最初の文字はアルファベットか`_`
	- `1st_hoge`、`2nd_hoge`など数字始まりはエラー
- 単語のつなぎ目は`_`
	- 例：`sparta_camp`

## 数値
次の演算子で計算が可能。

演算子|内容|
-----|----|
+|足し算|
-|引き算|
*|かけ算|
/|割り算|
%|余り|

## 文字列
二重引用符か一重引用符で文字列を表す。

```ruby
puts "これは文字列です"
puts 'これも文字列です'
pus 100 # これは数値
pus "100" # これは文字列
```

### 式展開
二重引用符の中では、`#{式}`で中の式が文字列に展開される。

```ruby
koushi = "名城"
puts "スパルタキャンプの講師は#{koushi}です"
```

一重引用符では使えない。注意。

### シンボル
シンボルとは、一意性のある文字列。`:`をつけるとシンボルになる。`:login_user`など。
シンボルを使うとメモリ効率が良くなる。

Railsでめちゃくちゃ使われる。とりあえず文字列の仲間と考えてOK。

## 配列とハッシュ
### 配列（Array）
データを入れておく「箱（変数）」の中に仕切りを作って分けられるようにするもの。

- `配列名[インデックス] = 格納したいオブジェクト`が基本セット
- 配列に入れた順に番号（インデックスと言います）がふられる
	- インデックスは`0`からスタートする。はじめは勘違いしやすいので注意！

```ruby
yamanote = ["新宿", "池袋", "東京", "品川", "大崎"]
# 配列名[番号]でアクセスできる。
puts yamanote[0]
=> 新宿
puts yamanote[5]
=> nil

yamanote[5] = "渋谷"
puts yamanote[5]
=> 渋谷

# 配列の大きさを調べるにはsizeメソッド
yamanote.size
=> 5

# 同じ配列に複数種類のオブジェクトを格納できる
caos = [34, "foo", true, 4.3]

```

配列の入れ子も可能

```ruby
ireko = [[405, 123], [543, 764, 677], [24, 5]]
p ireko[1][1]
=> 764

```

### ハッシュ（Hash）
配列とほぼ同じだが、番号管理ではなくラベル管理となっている。ラベル名を「キー」と呼び、キーは自分で決める。

- `"キー" => 値`が基本セット。
	- `:キー => 値`でもOK。シンボルをキーとしている。Railsはこっちの書き方が多い。
- 基本セットを`{}`で囲む
	- 配列は要素を`[]`で囲む。違いに注意！
- `ハッシュ名[”キー”]`か`ハッシュ名[:キー]`で取り出せる。

```
fruits = { "apple" => 200, "orange" => 150, "cherry" => 300 }
puts fruits["orange"]
=> 150

# シンボル版
login_user = { :id => 372, :name => "Daisuke", :email => "n@wmegane.com", :DM => true }
puts login_user[:name]
=> "Daisuke"
``` 

入れ子も可能。

```
all_user = {
	:nashirox => { :id => 372, :name => "Daisuke", :email => "n@wmegane.com", :DM => true },
	:mohira =>   { :id => 264, :name => "Ohira", :email => "ohira@nowall.com", :DM => false }
}

all_user[:mohira][:id]
=> 264
```

## コメント
### 一行コメントアウト
`#`以降はコメントアウトされる。

```ruby
puts "コメントテスト"
# なにを書いても無視されます
puts "コメントテスト"
```

下記の面でよく使う。

- なぜこのプログラムを書いているかの説明（未来の自分やチームメンバー向け）
- デバッグ中に、プログラムの一部を簡易的に読み込ませないようにする

なお、Sublime Textでは`command + /`で選択行がコメントアウトされる。便利。

### 複数行コメントアウト
あまり使わない。

```ruby
puts "コメントテスト"
=begin
  puts "この間は"
  puts "何を書いても無視されます。"
=end
puts "コメントテスト"
```

## 制御構造
### 条件判断系
#### if

```ruby
if 条件 then
  条件がtrueの時に実行したい処理
end
```

#### if + else

```ruby
if 条件１ then
  条件１がtrueの時に実行したい処理
elsif 条件２ then
  条件２がtrueの時に実行したい処理
else
  全条件がfalseの時に実行したい処理
end
```

#### unless
`if`とは逆の条件判断。あまり使わない。

```ruby
unless 条件 then
  条件がfalseの時に実行したい処理
end
```

### 繰り返し系
#### timesメソッド

```ruby
10.times do
  puts "10回この内容が出力されます。"
end

10.times { puts "10回この内容が出力されます。" }

```

#### eachメソッド
Railsで非常に多用するメソッド。配列やハッシュの要素に順番にアクセスできる。

#### 配列.each
```ruby
配列.each do |変数|
  繰り返し処理
end
```

- `do〜end`を**ブロック**と呼ぶ
- 配列が先頭から一つずつ取り出されて`|変数|`に格納され、それをブロック内で用いて処理をする

```ruby
yamanote = ["新宿", "池袋", "東京", "品川", "大崎"]

yamanote.each do |station|
  puts "次は#{station}駅です。"
end
=> 次は新宿駅です。
=> 次は池袋駅です。
=> 次は東京駅です。
=> 次は品川駅です。
=> 次は大崎駅です
```

次のように、`do〜end`を`{〜}`に置き換えて書くこともできる

```ruby
yamanote.each { |station| puts "次は#{station}駅です。" }
```

- Ruby界の慣習として、複数行に渡る処理の場合は`do〜end`、一行ですむ場合は`{〜}`で記述する。
- Railsはほぼ`do〜end`だけなので、これだけ覚えればとりあえずOK。

#### ハッシュ
```ruby
ハッシュ.each do |キーの変数, 値の変数|
  繰り返し処理
end
```

- 配列のeachとほぼ同じだが、キーと値の２つの変数を設定することができる。

```ruby
fruits = { "apple" => 200, "orange" => 150, "cherry" => 300 }

fruits.each do |fruit, price|
  puts "#{fruit}の値段は#{price}円です"
end
=> appleの値段は200円です
=> orangeの値段は150円です
=> cherryの値段は300円です
```

```ruby
all_user = {
	:nashirox => { :id => 372, :name => "Daisuke", :email => "n@wmegane.com", :DM => true },
	:mohira =>   { :id => 264, :name => "Ohira", :email => "ohira@nowall.com", :DM => false }
}

all_user.each do |name, info|
  puts "#{info[:name]}さんの情報"
  puts "メールアドレス：#{info[:email]}"
  puts "ＤＭ送信の可否：#{info[:DM]}"
  puts "----------------------"
end
=> Daisukeさんの情報
=> メールアドレス：n@wmegane.com
=> ＤＭ送信の可否：true
=> ----------------------
=> Ohiraさんの情報
=> メールアドレス：ohira@nowall.com
=> ＤＭ送信の可否：false
=> ----------------------
```


## メソッド
### メソッドの呼び出し

### メソッドの自作
Railsは複数のメソッドを自作していくことで、アプリ開発を進めていく。

```ruby
def メソッド名(引数1, 引数2, ...)
  実行処理
end
```

メソッドは作るだけではなく、呼び出さないと何も起こらない。

```ruby
def what_time_is_it?
  puts Time.now
end

what_time_is_it?() # メソッドの呼び出し
=> 2015-06-04 22:52:59 +0900 # メソッドの返り値
```


